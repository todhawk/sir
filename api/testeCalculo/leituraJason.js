// var obj = {
//   "geladeira" : {
//     "-KdGrFWomWxntPr8H0Hw" : {
//       "ano" : 2017,
//       "dia" : 18,
//       "diaSemana" : 6,
//       "hora" : 13,
//       "mes" : 1,
//       "minuto" : 35,
//       "segundo" : 24,
//       "status" : 1,
//       "timestamp" : 1487432124490
//     },
//     "-KdGrK_LnHuAIezcE5DF" : {
//       "ano" : 2017,
//       "dia" : 18,
//       "diaSemana" : 6,
//       "hora" : 13,
//       "mes" : 1,
//       "minuto" : 35,
//       "segundo" : 45,
//       "status" : 0,
//       "timestamp" : 1487432145185
//     },
//     "-KdGrS2xZPiiUTbRfHPE" : {
//       "ano" : 2017,
//       "dia" : 18,
//       "diaSemana" : 6,
//       "hora" : 13,
//       "mes" : 1,
//       "minuto" : 36,
//       "segundo" : 15,
//       "status" : 1,
//       "timestamp" : 1487432176210
//     },
//     "-KdH5QTD-sYvPo6QRQdc" : {
//       "ano" : 2017,
//       "dia" : 18,
//       "diaSemana" : 6,
//       "hora" : 14,
//       "mes" : 1,
//       "minuto" : 41,
//       "segundo" : 43,
//       "status" : 0,
//       "timestamp" : 1487436102083
//     },
//     "-KdQfZN3RexRw2qUJUi_" : {
//       "ano" : 2017,
//       "dia" : 20,
//       "diaSemana" : 1,
//       "hora" : 10,
//       "mes" : 1,
//       "minuto" : 20,
//       "segundo" : 32,
//       "status" : 1,
//       "timestamp" : 1487596833038
//     },
//     "-KdQfyyFi2IiKm0SFOB2" : {
//       "ano" : 2017,
//       "dia" : 20,
//       "diaSemana" : 1,
//       "hora" : 10,
//       "mes" : 1,
//       "minuto" : 22,
//       "segundo" : 21,
//       "status" : 0,
//       "timestamp" : 1487596942694
//     },
//     "-KdQgbctEk1p_CwAeWyE" : {
//       "ano" : 2017,
//       "dia" : 20,
//       "diaSemana" : 1,
//       "hora" : 10,
//       "mes" : 1,
//       "minuto" : 25,
//       "segundo" : 7,
//       "status" : 1,
//       "timestamp" : 1487597108299
//     },
//     "-KdQh4jX6tTcgWEXzNi0" : {
//       "ano" : 2017,
//       "dia" : 20,
//       "diaSemana" : 1,
//       "hora" : 10,
//       "mes" : 1,
//       "minuto" : 27,
//       "segundo" : 11,
//       "status" : 0,
//       "timestamp" : 1487597232248
//     }
//   },
//   "lavabo" : {
//     "-KdQgjbarNmVkyypZeC5" : {
//       "ano" : 2017,
//       "dia" : 20,
//       "diaSemana" : 1,
//       "hora" : 10,
//       "mes" : 1,
//       "minuto" : 25,
//       "segundo" : 40,
//       "status" : 1,
//       "timestamp" : 1487597142044
//     },
//     "-KdQgxWC6LZDuIIyqDqt" : {
//       "ano" : 2017,
//       "dia" : 20,
//       "diaSemana" : 1,
//       "hora" : 10,
//       "mes" : 1,
//       "minuto" : 26,
//       "segundo" : 37,
//       "status" : 0,
//       "timestamp" : 1487597201827
//     }
//   },
//   "luzCozinha" : {
//     "-KdQfqX0S_AdrxxO3IaX" : {
//       "ano" : 2017,
//       "dia" : 20,
//       "diaSemana" : 1,
//       "hora" : 10,
//       "mes" : 1,
//       "minuto" : 21,
//       "segundo" : 46,
//       "status" : 1,
//       "timestamp" : 1487596910000
//     },
//     "-KdQgVxRAgcH39JnfTty" : {
//       "ano" : 2017,
//       "dia" : 20,
//       "diaSemana" : 1,
//       "hora" : 10,
//       "mes" : 1,
//       "minuto" : 24,
//       "segundo" : 40,
//       "status" : 0,
//       "timestamp" : 1487597081060
//     }
//   },
//   "luzSala" : {
//     "-KdGr7ScAms7CbsG-UUT" : {
//       "ano" : 2017,
//       "dia" : 18,
//       "diaSemana" : 6,
//       "hora" : 13,
//       "mes" : 1,
//       "minuto" : 34,
//       "segundo" : 51,
//       "status" : 1,
//       "timestamp" : 1487432091501
//     },
//     "-KdGrOfKO6eXw9TVSaoB" : {
//       "ano" : 2017,
//       "dia" : 18,
//       "diaSemana" : 6,
//       "hora" : 13,
//       "mes" : 1,
//       "minuto" : 36,
//       "segundo" : 2,
//       "status" : 0,
//       "timestamp" : 1487432161973
//     },
//     "-KdQfLlVXPRXNjmsldhP" : {
//       "ano" : 2017,
//       "dia" : 20,
//       "diaSemana" : 1,
//       "hora" : 10,
//       "mes" : 1,
//       "minuto" : 19,
//       "segundo" : 36,
//       "status" : 1,
//       "timestamp" : 1487596779764
//     },
//     "-KdQgDSs9d92ingJRUVj" : {
//       "ano" : 2017,
//       "dia" : 20,
//       "diaSemana" : 1,
//       "hora" : 10,
//       "mes" : 1,
//       "minuto" : 23,
//       "segundo" : 24,
//       "status" : 0,
//       "timestamp" : 1487597007557
//     },
//     "-KdQgsLjQJjye1XYrnXc" : {
//       "ano" : 2017,
//       "dia" : 20,
//       "diaSemana" : 1,
//       "hora" : 10,
//       "mes" : 1,
//       "minuto" : 26,
//       "segundo" : 16,
//       "status" : 1,
//       "timestamp" : 1487597177518
//     },
//     "-KdQhK_n1IKk90GRoGq1" : {
//       "ano" : 2017,
//       "dia" : 20,
//       "diaSemana" : 1,
//       "hora" : 10,
//       "mes" : 1,
//       "minuto" : 28,
//       "segundo" : 15,
//       "status" : 0,
//       "timestamp" : 1487597296849
//     }
//   }
// }


var search = {};

search.timestampDevices = [];
search.statusDevices = [];
search.days = [];

search.getAll = function(x) {  //retorna as informações contidas no db e preenche algumas variáveis
  this.timestampDevices = [];
  this.statusDevices = [];
  this.days = [];

  var obj = {
    "geladeira" : {
      "-KdGrFWomWxntPr8H0Hw" : {
        "ano" : 2017,
        "dia" : 18,
        "diaSemana" : 6,
        "hora" : 13,
        "mes" : 1,
        "minuto" : 35,
        "segundo" : 24,
        "status" : 1,
        "timestamp" : 1487432124490
      },
      "-KdGrK_LnHuAIezcE5DF" : {
        "ano" : 2017,
        "dia" : 18,
        "diaSemana" : 6,
        "hora" : 13,
        "mes" : 1,
        "minuto" : 35,
        "segundo" : 45,
        "status" : 0,
        "timestamp" : 1487432145185
      },
      "-KdGrS2xZPiiUTbRfHPE" : {
        "ano" : 2017,
        "dia" : 18,
        "diaSemana" : 6,
        "hora" : 13,
        "mes" : 1,
        "minuto" : 36,
        "segundo" : 15,
        "status" : 1,
        "timestamp" : 1487432176210
      },
      "-KdH5QTD-sYvPo6QRQdc" : {
        "ano" : 2017,
        "dia" : 18,
        "diaSemana" : 6,
        "hora" : 14,
        "mes" : 1,
        "minuto" : 41,
        "segundo" : 43,
        "status" : 0,
        "timestamp" : 1487436102083
      },
      "-KdQfZN3RexRw2qUJUi_" : {
        "ano" : 2017,
        "dia" : 20,
        "diaSemana" : 1,
        "hora" : 10,
        "mes" : 1,
        "minuto" : 20,
        "segundo" : 32,
        "status" : 1,
        "timestamp" : 1487596833038
      },
      "-KdQfyyFi2IiKm0SFOB2" : {
        "ano" : 2017,
        "dia" : 20,
        "diaSemana" : 1,
        "hora" : 10,
        "mes" : 1,
        "minuto" : 22,
        "segundo" : 21,
        "status" : 0,
        "timestamp" : 1487596942694
      },
      "-KdQgbctEk1p_CwAeWyE" : {
        "ano" : 2017,
        "dia" : 21,
        "diaSemana" : 1,
        "hora" : 10,
        "mes" : 1,
        "minuto" : 25,
        "segundo" : 7,
        "status" : 1,
        "timestamp" : 1487597108299
      },
      "-KdQh4jX6tTcgWEXzNi0" : {
        "ano" : 2017,
        "dia" : 21,
        "diaSemana" : 1,
        "hora" : 10,
        "mes" : 1,
        "minuto" : 27,
        "segundo" : 11,
        "status" : 0,
        "timestamp" : 1487597232248
      }
    },
    "lavabo" : {
      "-KdQgjbarNmVkyypZeC5" : {
        "ano" : 2017,
        "dia" : 20,
        "diaSemana" : 1,
        "hora" : 10,
        "mes" : 1,
        "minuto" : 25,
        "segundo" : 40,
        "status" : 1,
        "timestamp" : 1487597142044
      },
      "-KdQgxWC6LZDuIIyqDqt" : {
        "ano" : 2017,
        "dia" : 20,
        "diaSemana" : 1,
        "hora" : 10,
        "mes" : 1,
        "minuto" : 26,
        "segundo" : 37,
        "status" : 0,
        "timestamp" : 1487597201827
      }
    },
    "luzCozinha" : {
      "-KdQfqX0S_AdrxxO3IaX" : {
        "ano" : 2017,
        "dia" : 20,
        "diaSemana" : 1,
        "hora" : 10,
        "mes" : 1,
        "minuto" : 21,
        "segundo" : 46,
        "status" : 1,
        "timestamp" : 1487596910000
      },
      "-KdQgVxRAgcH39JnfTty" : {
        "ano" : 2017,
        "dia" : 20,
        "diaSemana" : 1,
        "hora" : 10,
        "mes" : 1,
        "minuto" : 24,
        "segundo" : 40,
        "status" : 0,
        "timestamp" : 1487597081060
      }
    },
    "luzSala" : {
      "-KdGr7ScAms7CbsG-UUT" : {
        "ano" : 2017,
        "dia" : 18,
        "diaSemana" : 6,
        "hora" : 13,
        "mes" : 1,
        "minuto" : 34,
        "segundo" : 51,
        "status" : 1,
        "timestamp" : 1487432091501
      },
      "-KdGrOfKO6eXw9TVSaoB" : {
        "ano" : 2017,
        "dia" : 18,
        "diaSemana" : 6,
        "hora" : 13,
        "mes" : 1,
        "minuto" : 36,
        "segundo" : 2,
        "status" : 0,
        "timestamp" : 1487432161973
      },
      "-KdQfLlVXPRXNjmsldhP" : {
        "ano" : 2017,
        "dia" : 20,
        "diaSemana" : 1,
        "hora" : 10,
        "mes" : 1,
        "minuto" : 19,
        "segundo" : 36,
        "status" : 1,
        "timestamp" : 1487596779764
      },
      "-KdQgDSs9d92ingJRUVj" : {
        "ano" : 2017,
        "dia" : 20,
        "diaSemana" : 1,
        "hora" : 10,
        "mes" : 1,
        "minuto" : 23,
        "segundo" : 24,
        "status" : 0,
        "timestamp" : 1487597007557
      },
      "-KdQgsLjQJjye1XYrnXc" : {
        "ano" : 2017,
        "dia" : 20,
        "diaSemana" : 1,
        "hora" : 10,
        "mes" : 1,
        "minuto" : 26,
        "segundo" : 16,
        "status" : 1,
        "timestamp" : 1487597177518
      },
      "-KdQhK_n1IKk90GRoGq1" : {
        "ano" : 2017,
        "dia" : 20,
        "diaSemana" : 1,
        "hora" : 10,
        "mes" : 1,
        "minuto" : 28,
        "segundo" : 15,
        "status" : 0,
        "timestamp" : 1487597296849
      }
    }
  };

  var keysFirtObj = Object.keys(obj);

  var objSlice = [];
  for(var i=0 ; i<Object.keys(obj).length ; i++){
    objSlice.push(obj[keysFirtObj[i]]);
  };

  var unicKeys = "";
  var valueObj = [];

  for(var i=0 ; i<Object.keys(objSlice).length ; i++){
    unicKeys = Object.keys(objSlice[i]);
    valueObj = objSlice[i];

    for(var j=0 ; j<Object.keys(unicKeys).length ; j++){
      var values = valueObj[unicKeys[j]];
      this.timestampDevices.push(values["timestamp"]);
      this.statusDevices.push(values["status"]);
      this.days.push(values["dia"]);
    };
    console.log("\n\n" + keysFirtObj[i] + "\n\n");
    if(x == "day"){
      this.filterThisDay();
    };


    // console.log("Timestamp " , keysFirtObj[i] , ": " , this.timestampDevices);
    // console.log("Status " , keysFirtObj[i] , ": " , this.statusDevices);
    // console.log("Dia " , keysFirtObj[i] , ": " , this.days);
    valueObj = [];
  };
};

search.filterBetween = function(start,end) { //retorna o tempo de utilização em um determinado intervalo de dias
  //coleta as dados contidos nas variáveis timestampDevices, statusDevices etc
  //e seleciona os dados com entre uma data Ex. dia x até dia y.
};

search.filterThisDay = function() {
  var today = new Date();
  var result = 0;
  for(var i=0 ; i<this.statusDevices.length ; i++){
    console.log(i);
    console.log(this.timestampDevices[i]);
    if(this.days[i] == today.getDate()){
      if (this.statusDevices[i] == 1 && this.statusDevices[i+1] == 0) {
        result += this.timestamp[i+1] - this.timestamp[i];
      };
    };
  };
  // console.log(result);
  return result;
};

search.filterLastDays = function() {

};

search.filterLastWeek = function() {

};

search.filterLastMonth = function() {

};

search.filterLastYear = function() {

};

search.calcTimeUsed = function(status,timestamp){
  var result = 0;
  for(var i=0 ; i<status.length ; i++){
    if (status[i] == 1 && status[i+1] == 0) {
        result += timestamp[i+1] - timestamp[i];
    };
  };
  return result;
}; //end function calcTimeUsed



// var timestampDevices = [];
// var statusDevices = [];
// var dayUsed = [];

// var timesUse = []; // este vetor contera a somatoria de tempo de USO de cada device listado onde cada indice representa um device

// var calcTime = function(status,timestamp) {
//   var result = 0;
//   for(var i=0 ; i<status.length ; i++){
//     if (status[i] == 1 && status[i+1] == 0) {
//         result += timestamp[i+1] - timestamp[i];
//     };
//   };
//   timesUse.push(result);
// };

// var keysFirtObj = Object.keys(obj);
//
// var objSlice = [];
// for(var i=0 ; i<Object.keys(obj).length ; i++){
//   objSlice.push(obj[keysFirtObj[i]]);
// };
//
// var unicKeys = "";
// var valueObj = [];
//
// for(var i=0 ; i<Object.keys(objSlice).length ; i++){
//   unicKeys = Object.keys(objSlice[i]);
//   valueObj = objSlice[i];
//   console.log(keysFirtObj[i]);
//
//   for(var j=0 ; j<Object.keys(unicKeys).length ; j++){
//     var values = valueObj[unicKeys[j]];
//     timestampDevices.push(values["timestamp"]);
//     statusDevices.push(values["status"]);
//     dayUsed.push(values["dia"]);
//
//     console.log("\n");
//   };
//   console.log("Timestamp " , keysFirtObj[i] , ": " , timestampDevices);
//   console.log("Status " , keysFirtObj[i] , ": " , statusDevices);
//   console.log("Dia " , keysFirtObj[i] , ": " , dayUsed);
//
//   calcTime(statusDevices,timestampDevices);
//
//   timestampDevices = [];
//   statusDevices = [];
//   valueObj = [];
// };
// console.log(timesUse);
